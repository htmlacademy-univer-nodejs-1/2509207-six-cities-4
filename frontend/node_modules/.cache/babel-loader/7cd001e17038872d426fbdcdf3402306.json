{"ast":null,"code":"import axios from 'axios';\nimport { toast } from 'react-toastify';\nimport { Token } from './utils';\nconst BACKEND_URL = 'http://localhost:3000';\nconst REQUEST_TIMEOUT = 5000;\nexport const createAPI = () => {\n  const api = axios.create({\n    baseURL: BACKEND_URL,\n    timeout: REQUEST_TIMEOUT\n  });\n  api.interceptors.request.use(config => {\n    const token = Token.get();\n\n    if (token) {\n      config.headers['Authorization'] = `Bearer ${token}`;\n    }\n\n    return config;\n  });\n  api.interceptors.response.use(response => response, error => {\n    toast.dismiss();\n    toast.warn(error.response ? error.response.data.error : error.message);\n    return Promise.reject(error);\n  });\n  return api;\n};","map":{"version":3,"names":["axios","toast","Token","BACKEND_URL","REQUEST_TIMEOUT","createAPI","api","create","baseURL","timeout","interceptors","request","use","config","token","get","headers","response","error","dismiss","warn","data","message","Promise","reject"],"sources":["/Users/vovotata/nodejs/2509207-six-cities-4/frontend/src/api.ts"],"sourcesContent":["import axios, { AxiosInstance, AxiosRequestConfig, AxiosError } from 'axios';\nimport { toast } from 'react-toastify';\nimport { ValidationErrorField } from '../'\nimport { Token } from './utils';\n\nconst BACKEND_URL = 'http://localhost:3000';\nconst REQUEST_TIMEOUT = 5000;\n\nexport const createAPI = (): AxiosInstance => {\n  const api = axios.create({\n    baseURL: BACKEND_URL,\n    timeout: REQUEST_TIMEOUT,\n  });\n\n  api.interceptors.request.use(\n    (config: AxiosRequestConfig) => {\n      const token = Token.get();\n\n      if (token) {\n        config.headers['Authorization'] = `Bearer ${token}`;\n      }\n\n      return config;\n    }\n  );\n\n  api.interceptors.response.use(\n    (response) => response,\n    (error: AxiosError) => {\n      toast.dismiss();\n      toast.warn(error.response ? error.response.data.error : error.message);\n\n      return Promise.reject(error);\n    }\n  );\n\n  return api;\n};\n"],"mappings":"AAAA,OAAOA,KAAP,MAAqE,OAArE;AACA,SAASC,KAAT,QAAsB,gBAAtB;AAEA,SAASC,KAAT,QAAsB,SAAtB;AAEA,MAAMC,WAAW,GAAG,uBAApB;AACA,MAAMC,eAAe,GAAG,IAAxB;AAEA,OAAO,MAAMC,SAAS,GAAG,MAAqB;EAC5C,MAAMC,GAAG,GAAGN,KAAK,CAACO,MAAN,CAAa;IACvBC,OAAO,EAAEL,WADc;IAEvBM,OAAO,EAAEL;EAFc,CAAb,CAAZ;EAKAE,GAAG,CAACI,YAAJ,CAAiBC,OAAjB,CAAyBC,GAAzB,CACGC,MAAD,IAAgC;IAC9B,MAAMC,KAAK,GAAGZ,KAAK,CAACa,GAAN,EAAd;;IAEA,IAAID,KAAJ,EAAW;MACTD,MAAM,CAACG,OAAP,CAAe,eAAf,IAAmC,UAASF,KAAM,EAAlD;IACD;;IAED,OAAOD,MAAP;EACD,CATH;EAYAP,GAAG,CAACI,YAAJ,CAAiBO,QAAjB,CAA0BL,GAA1B,CACGK,QAAD,IAAcA,QADhB,EAEGC,KAAD,IAAuB;IACrBjB,KAAK,CAACkB,OAAN;IACAlB,KAAK,CAACmB,IAAN,CAAWF,KAAK,CAACD,QAAN,GAAiBC,KAAK,CAACD,QAAN,CAAeI,IAAf,CAAoBH,KAArC,GAA6CA,KAAK,CAACI,OAA9D;IAEA,OAAOC,OAAO,CAACC,MAAR,CAAeN,KAAf,CAAP;EACD,CAPH;EAUA,OAAOZ,GAAP;AACD,CA7BM"},"metadata":{},"sourceType":"module"}